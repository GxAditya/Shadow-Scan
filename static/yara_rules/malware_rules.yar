rule SuspiciousPE {
    meta:
        description = "Detects suspicious PE characteristics"
        severity = "medium"
    strings:
        $s1 = "LoadLibraryA" ascii wide
        $s2 = "VirtualAlloc" ascii wide
        $s3 = "CreateRemoteThread" ascii wide
        $pdb = /\.pdb$/ 
    condition:
        uint16(0) == 0x5A4D and
        2 of ($s*) and
        not $pdb
}

rule PotentialRansomware {
    meta:
        description = "Detects potential ransomware indicators"
        severity = "high"
    strings:
        $encrypt1 = "encrypt" nocase ascii wide
        $encrypt2 = "AES" ascii wide
        $encrypt3 = "RSA" ascii wide
        $ransom = "ransom" nocase ascii wide
        $bitcoin = "bitcoin" nocase ascii wide
    condition:
        2 of ($encrypt*) and
        any of ($ransom, $bitcoin)
}

rule SuspiciousDocument {
    meta:
        description = "Detects suspicious office documents"
        severity = "medium"
    strings:
        $macro = "AutoExec" ascii wide
        $ole = {D0 CF 11 E0}
        $sus1 = "powershell" nocase ascii wide
        $sus2 = "cmd.exe" nocase ascii wide
    condition:
        ($ole at 0) and
        any of ($sus*) and
        $macro
}
